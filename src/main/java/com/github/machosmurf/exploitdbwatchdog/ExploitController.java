package com.github.machosmurf.exploitdbwatchdog;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.util.List;

@Component
public class ExploitController {

    private ExploitRepository exploitRepository;

    @Autowired
    public ExploitController(ExploitRepository exploitRepository){
        this.exploitRepository = exploitRepository;
    }

    public Exploit getExploitById(int exploitID) {
        return exploitRepository.findByExploitID(exploitID);
    }

    public List<Exploit> getExploitsByAuthor(String author) {
        return exploitRepository.findByGeneralTypeAndAuthor(GeneralType.Exploit, author);
    }

    public List<Exploit> getExploitsByType(String type) {
        return exploitRepository.findExploitsByType(type);
    }

    public List<Exploit> getExploitsByPlatform(String platform) {
        return exploitRepository.findExploitsByPlatform(platform);
    }

    public List<Exploit> searchPaperByLanguageAndTags(String language, String tag) {
        return exploitRepository.findByLanguageAndDescriptionContaining(language, tag);
    }

    public List<Exploit> getPaperByLanguage(String language) {
        return exploitRepository.findByLanguage(language);
    }

    public List<Exploit> getPaperByAuthor(String author) {
        return exploitRepository.findByGeneralTypeAndAuthor(GeneralType.Paper, author);
    }

    public List<Exploit> searchExploitByTags(String tags) {
        return exploitRepository.findByGeneralTypeAndDescriptionContaining(GeneralType.Exploit, tags);
    }
}
