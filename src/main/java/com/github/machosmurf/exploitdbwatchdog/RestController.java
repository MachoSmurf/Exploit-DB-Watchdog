package com.github.machosmurf.exploitdbwatchdog;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

import java.util.List;

@org.springframework.web.bind.annotation.RestController
public class RestController {

    private UserController userController;
    private ExploitController exploitController;

    @Autowired
    public RestController(UserController userController,
                          ExploitController exploitController){
        this.userController = userController;
        this.exploitController = exploitController;
    }

    @RequestMapping(value = "/Exploit/{id}", method = RequestMethod.GET)
    public Exploit getExploitById(@PathVariable int exploitID){
        return exploitController.getExploitById(exploitID);
    }

    @RequestMapping(value = "/Exploit/Author/{author}", method = RequestMethod.GET)
    public List<Exploit> getExploitByAuthor(@PathVariable String author){
        return exploitController.getExploitsByAuthor(author);
    }

    @RequestMapping(value = "/Exploit/Type/{type}", method = RequestMethod.GET)
    public List<Exploit> getExploitByType(@PathVariable String type){
        return exploitController.getExploitsByType(type);
    }

    @RequestMapping(value = "/Exploit/Platform/{platform}", method = RequestMethod.GET)
    public List<Exploit> getExploitByPlatform(@PathVariable String platform){
        return exploitController.getExploitsByPlatform(platform);
    }

}
